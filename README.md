This is an completely rewritten version of the original blockal
